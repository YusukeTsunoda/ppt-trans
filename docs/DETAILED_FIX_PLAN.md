# PowerPoint翻訳アプリ - 詳細修正計画

## 現状の問題点

### 1. ルーティング構造の問題
- **現状**: `/` (ルート)が直接アップロード画面になっている
- **期待**: `/` にLPページ、`/upload` にアップロード機能
- **影響**: 未認証ユーザーが直接アップロード画面にアクセスできてしまう

### 2. CSS/Tailwindの問題
- **現状**: 
  - 背景が真っ黒
  - 文字が全て左寄せ
  - `tailwind.config.js`が正しく設定されたが適用されていない
- **原因**: CSS変数とTailwindクラスの競合、またはビルドプロセスの問題

### 3. 認証フローの問題
- **現状**: 
  - `/upload`ページが独立して存在
  - ダッシュボードとアップロード機能が分離
  - middlewareで保護されているが、LPページがない

## 修正実装計画

### フェーズ1: LPページの作成（優先度: 高）

#### 1.1 新しいLPページコンポーネントの作成
```
src/app/(marketing)/page.tsx  # 新しいLPページ
src/components/landing/       # LPコンポーネント群
  ├── Hero.tsx               # ヒーローセクション
  ├── Features.tsx           # 機能紹介
  ├── Pricing.tsx            # 料金プラン
  ├── HowItWorks.tsx         # 使い方
  └── Footer.tsx             # フッター
```

#### 1.2 現在のpage.tsxの移動
- 現在の`src/app/page.tsx`を`src/app/(auth)/upload/page.tsx`に移動
- または既存の`/upload`ページと統合

### フェーズ2: ルーティング構造の再編成

#### 2.1 ディレクトリ構造の整理
```
src/app/
├── (marketing)/          # 公開ページ
│   ├── page.tsx         # LPページ
│   ├── pricing/         # 料金ページ
│   └── about/           # 会社概要
├── (auth)/              # 認証が必要なページ
│   ├── dashboard/       # ダッシュボード
│   ├── upload/          # アップロード
│   ├── files/           # ファイル管理
│   └── preview/         # プレビュー
└── (public)/            # 認証関連ページ
    ├── login/           # ログイン
    ├── register/        # 登録
    └── forgot-password/ # パスワードリセット
```

#### 2.2 Middlewareの更新
```typescript
// 保護されたパスの更新
const protectedPaths = [
  '/dashboard',
  '/upload', 
  '/files',
  '/preview',
  '/profile',
  '/admin'
];

// 公開パスの追加
const publicPaths = [
  '/',
  '/pricing',
  '/about',
  '/login',
  '/register',
  '/forgot-password'
];
```

### フェーズ3: ダッシュボードの統合

#### 3.1 ダッシュボードにアップロード機能を統合
```typescript
// DashboardViewコンポーネントに追加
- ファイル一覧表示
- アップロードボタン/エリア
- ドラッグ&ドロップ対応
- 進捗表示
```

#### 3.2 ナビゲーション構造
```typescript
// 統一されたナビゲーション
- ダッシュボード（ホーム）
- ファイル管理
- 新規アップロード（モーダルまたはページ内）
- プロフィール設定
- ログアウト
```

### フェーズ4: CSS/スタイリングの修正

#### 4.1 Tailwind設定の確認と修正
```javascript
// tailwind.config.jsの完全な設定
module.exports = {
  content: [
    './src/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        // カスタムカラー定義
      },
    },
  },
  plugins: [],
}
```

#### 4.2 globals.cssの整理
```css
/* CSS変数の整理 */
:root {
  /* ライトテーマ */
  --background: 255 255 255;
  --foreground: 0 0 0;
}

.dark {
  /* ダークテーマ */
  --background: 10 10 10;
  --foreground: 255 255 255;
}
```

#### 4.3 PostCSSビルドプロセスの確認
- PostCSS設定の確認
- Next.jsのビルドプロセス確認
- 開発サーバーの再起動

### フェーズ5: 認証フローの改善

#### 5.1 認証状態管理
```typescript
// 認証コンテキストの強化
- ローディング状態の管理
- エラーハンドリング
- セッション更新の自動化
```

#### 5.2 リダイレクトロジック
```typescript
// スムーズなリダイレクト
- ログイン後: 元のページまたはダッシュボード
- ログアウト後: LPページ
- 認証エラー: ログインページ
```

### フェーズ6: テストと検証

#### 6.1 E2Eテストの追加
- LPページの表示テスト
- 認証フローテスト
- アップロード機能テスト
- ダッシュボード統合テスト

#### 6.2 パフォーマンステスト
- ページロード速度
- CSS/JSバンドルサイズ
- 画像最適化

## 実装優先順位

1. **即座に修正すべき項目**（1-2時間）
   - Tailwind CSSの動作確認と修正
   - PostCSSビルドプロセスの確認

2. **短期的修正**（2-4時間）
   - LPページの基本実装
   - ルーティング構造の修正
   - middlewareの更新

3. **中期的改善**（4-8時間）
   - ダッシュボードへのアップロード統合
   - 認証フローの改善
   - UIコンポーネントの統一

4. **長期的最適化**（8時間以上）
   - 完全なテストカバレッジ
   - パフォーマンス最適化
   - アクセシビリティ改善

## リスクと対策

### リスク1: 既存機能の破壊
**対策**: 
- 段階的な実装
- 各フェーズ後のテスト
- gitブランチ戦略の活用

### リスク2: 認証フローの不具合
**対策**:
- 既存の認証ロジックを保持
- 段階的な移行
- E2Eテストでの検証

### リスク3: スタイリングの競合
**対策**:
- CSS Modulesの使用検討
- スコープ付きスタイル
- 段階的な移行

## 成功基準

1. **機能面**
   - LPページが正しく表示される
   - 認証フローが正常に動作
   - アップロード機能がダッシュボードから利用可能

2. **パフォーマンス**
   - ページロード3秒以内
   - Lighthouse Score 90以上

3. **ユーザビリティ**
   - 直感的なナビゲーション
   - レスポンシブデザイン
   - エラーメッセージの明確化

## 次のステップ

1. この計画のレビューと承認
2. 実装ブランチの作成
3. フェーズ1から順次実装
4. 各フェーズ完了後のテストとレビュー
5. 本番環境へのデプロイ